---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# miRNARefine

<!-- badges: start -->
<!-- badges: end -->
Useful Tool to Refine and Improve the Quality and Interpretability of miRNA Expression Data

## Description

`miRNARefine` is an R package which aims to identify and correct potential data irregularities such as outliers, batch effects, and instability in miRNA expression across samples, and to provide diagnostic visualizations that help researchers assess data reliability before downstream analyses.

`miRNARefine` was developed in the following environment:  
R version: 4.5.1 (2025-06-13) - "Great Square Root"  
Platform: Windows 11 x64(x86_64, mingw32)

## Installation

You can install the development version of miRNARefine like so:
``` r
# Install Bioconductor dependencies
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install(c("preprocessCore", "impute", "sva"), force = TRUE)

install.packages("devtools")
library("devtools")
devtools::install_github("feiyangsun246/miRNARefine", build_vignettes = TRUE)
library("miRNARefine")
```
To run the Shiny app:
```r
# Under construction
```

## Overview

To list all functions available in the package: 

``` r
ls("package:miRNARefine")
```
`miRNARefine` contains 7 functions:

1. _*adaptiveFiltering*_ Automatically filters miRNAs based on expression, variance, or missing
values.
2. _*detectOutliersPCA*_ Identifies anomalous samples using principal component analysis.
3. _*missingValueHandling*_ Detects and imputes missing values in the miRNA dataset. Supports
adaptive methods like mean, median, or KNN imputation.
4. _*compareNormalization*_ Applies multiple normalization methods (e.g., log2, z-score, quantile)
and compares their effects.
5. _*detectBatch*_ Detects and optionally corrects batch effects in the dataset.
6. _*miRNAStability*_ Calculates feature-level stability metrics such as coefficient of variation (CV) or median absolute deviation (MAD).
7. _*plotStabilityDistribution*_ Visualizes the distribution of miRNA stability metrics across
all features. Highlights highly stable or highly variable miRNAs, helping users quickly assess
feature quality.

<br>

To view datasets available in the package:

``` r
data(package = "miRNARefine") 
```

<br>

To view the tutorial of the package:

``` r
browseVignettes("miRNARefine")
```

The package also contains two datasets, called miRNASeq1 and miRNASeq2. Refer to package vignettes for more details. An overview of the package workflow is illustrated below.

![](inst/extdata/workflow.png)


## Contributions

The author of the package is Feiyang Sun. Feiyang designed the overall package structure, implemented all functions, wrote the documentation and vignettes, and performed testing and debugging. All analyses, visualizations, and examples included in the package were created by Feiyang, who is also responsible for maintaining and updating the package. `preprocessCore` is used to Provide quantile normalization methods for miRNA expression data. `stats` is used for feature stability and outlier detection. `impute` provides functions for KNN-based imputation of missing values. `sva` helps implement batch effect detection and correction methods. `ggplot2` is used for creating stability distribution plots.

`ChatGPT-5` from OpenAI was used to polish and format documentation structure, debug code, and look up function information.

## Package References

Bolstad B (2025). `preprocessCore`: A collection of pre-processing functions. R package version 1.72.0. <https://bioconductor.org/packages/preprocessCore>

Castelluzzo M, Detassis S, Denti M, Ricci L (2023). `MiRNAQCD`: Micro-RNA Quality Control and Diagnosis. R package version 1.1.3.<https://CRAN.R-project.org/package=MiRNAQCD>

Chodor W. (2025). `RTCGA.miRNASeq`: miRNASeq datasets from The Cancer Genome Atlas Project. R package version 1.36.0. <https://bioconductor.org/packages/RTCGA.miRNASeq>

CRAN Project (2023). `factoextra`: Extract and visualize the results of multivariate data analyses. <https://CRAN.R-project.org/package=factoextra>

Hastie T, Tibshirani R, Narasimhan B, Chu G (2025). `impute`: Imputation for microarray data. doi:10.18129/B9.bioc.impute. R package version 1.85.0, <https://bioconductor.org/packages/impute>

Leek JT, Johnson WE, Parker HS, Fertig EJ, Jaffe AE, Zhang Y, Storey JD, Torres LC (2025). `sva`: Surrogate Variable Analysis. doi:10.18129/B9.bioc.sva, R package version 3.58.0, <https://bioconductor.org/packages/sva>

R Core Team. (2025). Package `stats`. *R: A Language and Environment for Statistical Computing.* R Foundation for Statistical Computing, Vienna, Austria. <https://www.R-project.org/>

Wickham, H. (2016). `ggplot2`: Elegant graphics for data analysis. Springer-Verlag New York. <https://ggplot2.tidyverse.org>

## Other References

Bolstad, B. M., Irizarry, R. A., Astrand, M., & Speed, T. P. (2003). A comparison of normalization methods for high density oligonucleotide array data based on variance and bias. Bioinformatics, 19(2), 185â€“193.

Hastie, T., Tibshirani, R., & Friedman, J. (2009). The Elements of Statistical Learning, 2nd Edition. Springer.

Hima Bindu, A., Suresh, P., Reddy, R., et al. (2019). Systematic evaluation of miRNA stability across biological replicates. Frontiers in Molecular Biosciences, 6, 153.

Johnson, W. E., Li, C., & Rabinovic, A. (2007). Adjusting batch effects in microarray expression data using empirical Bayes methods. Biostatistics, 8(1), 118-127.

Jolliffe, I. T. (2002). Principal Component Analysis. Springer.

Leek, J. T., et al. (2010). Tackling the widespread and critical impact of batch effects in high-throughput data. Nature Reviews Genetics, 11(10), 733-739.

Li, R., et al. (2016). Evaluation of microRNA expression stability for normalization in quantitative PCR assays. Biochemical and Biophysical Research Communications}, 471(4), 567-574.

OpenAI. (2025). ChatGPT (Nov 3 version) [Large language model]. <https://chat.openai.com/>

## Acknowledgements

This package was developed as part of an assessment for 2025 BCB410H: Applied Bioinformatics
course at the University of Toronto, Toronto, CANADA. `miRNARefine` welcomes issues,
enhancement requests, and other contributions. To submit an issue, use the GitHub issues.
