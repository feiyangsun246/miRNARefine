% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dataQuality.R
\name{detectOutliersPCA}
\alias{detectOutliersPCA}
\title{Detect Outliers in miRNA Data Using PCA}
\usage{
detectOutliersPCA(
  miRNAdata,
  n_components = 2,
  row_threshold = 0.99,
  z_threshold = 3,
  whether_scale = TRUE,
  report_summary = TRUE
)
}
\arguments{
\item{miRNAdata}{A numeric matrix or data frame, samples in rows, miRNAs in columns.}

\item{n_components}{Number of principal components to use. Default 2.}

\item{row_threshold}{Quantile threshold for flagging outliers based on PCA distance. Default 0.99.}

\item{z_threshold}{Number of standard deviations for column-level outliers. Default 3.}

\item{whether_scale}{Logical, whether to standardize variables before PCA. Default TRUE.}

\item{report_summary}{Logical, whether to print the number of outliers detected. Default TRUE.}
}
\value{
A list with:
\itemize{
\item sample_outliers: logical vector for each sample
\item miRNA_outliers: logical matrix for each sample x miRNA
\item pca_res: prcomp object
\item scores: PCA scores
}
}
\description{
Identifies anomalous samples using principal component analysis (PCA)
following the approach of Jolliffe (2002). Samples that deviate strongly from
the multivariate center are flagged as outliers to improve data quality.
}
\examples{
\dontrun{
# Example 1:
Using miRNASeq data available with package
result <- detectOutliersPCA(miRNASeq1,
                            n_components = 2,
                            row_threshold = 0.99,
                            z_threshold = 3,
                            whether_scale = TRUE,
                            report_summary = TRUE)
result
which(result$sample_outliers)

# Example 2:
# Obtain an external sample miRNASeq dataset
# Example requires the RTCGA.miRNASeq package:
if (requireNamespace("RTCGA.miRNASeq", quietly = TRUE)) {
  library(RTCGA.miRNASeq)
  dim(ACC.miRNASeq) # 240 1048

  sample <- RTCGA.miRNASeq::ACC.miRNASeq[1:100, 1:20]
  result <- detectOutliersPCA(sample,
                              n_components = 2,
                              row_threshold = 0.99,
                              z_threshold = 3,
                              whether_scale = TRUE,
                              report_summary = TRUE)
  which(result$sample_outliers)
  result$miRNA_outliers[1:10, 1:5]
}}

}
\references{
Castelluzzo M, Detassis S, Denti M, Ricci L (2023).
\emph{MiRNAQCD: Micro-RNA Quality Control and Diagnosis}.
R package version 1.1.3.
\href{https://CRAN.R-project.org/package=MiRNAQCD}{Link}.

CRAN Project (2023). \emph{factoextra: Extract and visualize the results of
multivariate data analyses.}
\href{https://CRAN.R-project.org/package=factoextra}{Link}

Chodor, W. (2025). \emph{RTCGA.miRNASeq: miRNASeq datasets from The Cancer
Genome Atlas Project}. R package version 1.36.0.

Jolliffe, I. T. (2002). Principal Component Analysis. Springer.
}
